<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Data visualisation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">The Research Cycle</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="01_intro.html">1: intro</a>
</li>
<li>
  <a href="02_tidy.html">2: tidy</a>
</li>
<li>
  <a href="03_ggplot.html">3: ggplot</a>
</li>
<li>
  <a href="04_dplyr.html">4: dplyr</a>
</li>
<li>
  <a href="05_joins.html">5: joins</a>
</li>
<li>
  <a href="06_functions.html">6: functions</a>
</li>
<li>
  <a href="07_simulation.html">7: simulation</a>
</li>
<li>
  <a href="08_glm.html">8: glm</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Data visualisation</h1>

</div>


<div style="width: 25%; position: absolute; top: 0; right: 0; padding-top: 1em;">
<p><img src="images/x-all-the-things.png" alt="Visualise all the things" style="width:100%;" /> Visualise all the things</p>
</div>
<div id="learning-objectives" class="section level2 tabset">
<h2>Learning Objectives</h2>
<div id="basic" class="section level3">
<h3>Basic</h3>
<ol style="list-style-type: decimal">
<li>Understand what types of graphs are best for different types of data
<ul>
<li>Correlation</li>
<li>Distribution</li>
</ul></li>
<li>Create common types of graphs with ggplot2
<ul>
<li>bar plot (<code>geom_bar()</code>)</li>
<li>violin plot (<code>geom_violin()</code>)</li>
<li>boxplot (<code>geom_boxplot()</code>)</li>
<li>histogram (<code>geom_histogram()</code>)</li>
<li>density plot (<code>geom_density()</code>)</li>
<li>scatter plot (<code>geom_point()</code>)</li>
<li>line graph (<code>geom_smooth()</code>)</li>
</ul></li>
<li>Save plots as an image file</li>
</ol>
</div>
<div id="intermediate" class="section level3">
<h3>Intermediate</h3>
<ol start="4" style="list-style-type: decimal">
<li>Represent factorial designs with different colours or facets</li>
<li>Superimpose different types of graphs, e.g.:
<ul>
<li>boxplot on violin plot</li>
<li>jitter plot on violin plot</li>
<li>line graph on scatter plot</li>
</ul></li>
<li>Add lines to graphs</li>
<li>Deal with overlapping data</li>
<li>Use the <code>viridis</code> package to set colours</li>
<li>Set custom labels</li>
</ol>
</div>
<div id="advanced" class="section level3">
<h3>Advanced</h3>
<ol start="10" style="list-style-type: decimal">
<li>Arrange plots in a grid using <code>cowplot</code></li>
<li>Create less common types of graphs (e.g., heat map)</li>
<li>Adjust axes (e.g., flip coordinates, set axis limits)</li>
<li>Change the theme</li>
<li>Create animated plots with <a href="https://github.com/dgrtwo/gganimate"><code>gganimate</code></a></li>
</ol>
</div>
</div>
<div id="prep" class="section level2">
<h2>Prep</h2>
<ul>
<li>Read <a href="http://r4ds.had.co.nz/data-visualisation.html">Chapter 3</a> of <em>R for Data Science</em></li>
</ul>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<ul>
<li><a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf">ggplot2 cheat sheet</a></li>
<li><a href="http://ggplot2.tidyverse.org/reference/">ggplot2 documentation</a></li>
<li><a href="http://www.r-graph-gallery.com/">The R Graph Gallery</a> (this is really useful)</li>
<li><a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">Top 50 ggplot2 Visulaizations</a></li>
<li><a href="http://www.cookbook-r.com/Graphs/">R Graphics Cookbook</a> by Winston Chang</li>
<li><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">The viridis color palettes</a></li>
<li><a href="https://www.ggplot2-exts.org/">ggplot extensions</a></li>
<li><a href="https://plot.ly/ggplot2/">plotly</a> for creating interactive graphs</li>
</ul>
</div>
<div id="examples" class="section level2 tabset tabset-pills">
<h2>Examples</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># libraries needed for these graphs</span>
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(viridis)

<span class="co"># cowplot will change the default theme of graphs, so we&#39;re loading it later</span>
<span class="co"># library(cowplot) </span></code></pre></div>
<div id="data" class="section level3">
<h3>Data</h3>
<p>Here we’ve created some data frames with different types of data.</p>
<ul>
<li><code>demog</code> has <code>height</code> and <code>age</code> for 500 men and 500 women.</li>
<li><code>x_vs_y</code> has two correlated continuous variables (<code>x</code> and <code>y</code>)</li>
<li><code>overlap</code> has two correlated ordinal variables and 1000 observations so there is a lot of overlap</li>
</ul>
<p>First, think about what kinds of graphs are best for representing these different types of data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demog &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">sex =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>), <span class="dt">each =</span> <span class="dv">500</span>),
  <span class="dt">height =</span> <span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dv">70</span>, <span class="dv">4</span>), <span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dv">65</span>, <span class="fl">3.5</span>)),
  <span class="dt">age =</span> <span class="kw">rpois</span>(<span class="dv">1000</span>, <span class="dv">3</span>) +<span class="st"> </span><span class="dv">20</span>
)

x_vs_y &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>)
) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> x +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">0.5</span>))

overlap &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">x =</span> <span class="kw">rbinom</span>(<span class="dv">1000</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)
) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> x +<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.5</span>))</code></pre></div>
</div>
<div id="violin-plot" class="section level3">
<h3>Violin plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(sex, height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_violin</span>(
    <span class="dt">trim =</span> <span class="ot">FALSE</span>,
    <span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), 
    <span class="dt">alpha =</span> <span class="fl">0.5</span>
  )</code></pre></div>
<p><img src="images/02/violin-1.png" width="768" /></p>
<p class="alert alert-info">
Try changing the numbers in the <code>draw_quantiles</code> argument.
</p>
</div>
<div id="boxplot" class="section level3">
<h3>Boxplot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(sex, height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="images/02/boxplot-1.png" width="768" /></p>
</div>
<div id="violinbox-plot" class="section level3">
<h3>Violinbox plot</h3>
<p>To demonstrate the use of <code>facet_grid()</code> for factorial designs, I created a new column called <code>agegroup</code> to split the data into participants older than the meadian age or younger than the median age. I also got rid of the legend because it was redundant with the x-axis labels and changed the default colours.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demog %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">agegroup =</span> <span class="kw">ifelse</span>(age&lt;<span class="kw">median</span>(age), <span class="st">&quot;Younger&quot;</span>, <span class="st">&quot;Older&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(sex, height, <span class="dt">fill=</span>sex)) +
<span class="st">    </span><span class="kw">geom_violin</span>(<span class="dt">trim =</span> <span class="ot">FALSE</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) +
<span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.25</span>, <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">facet_grid</span>(.~agegroup) +
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>))</code></pre></div>
<p><img src="images/02/violinbox-1.png" width="768" /></p>
<p class="alert alert-info">
We set the <code>show.legend</code> argument to <code>FALSE</code> because the x-axis already labels the sexes.
</p>
</div>
<div id="violin-jitter-plot" class="section level3">
<h3>Violin-jitter plot</h3>
<p>If you don’t have a lot of data points, it’s good to represent them individually. You can use <code>geom_point</code> to do this, setting <code>position</code> to “jitter”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demog %&gt;%
<span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">50</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(sex, height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_violin</span>(
    <span class="dt">trim =</span> <span class="ot">FALSE</span>,
    <span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), 
    <span class="dt">alpha=</span><span class="fl">0.5</span>
  ) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">size =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="images/02/violin-jitter-1.png" width="768" /></p>
</div>
<div id="bar-plot" class="section level3">
<h3>Bar plot</h3>
<p>Bar plots are useful for count data, but but we really should <a href="https://barbarplots.github.io/">#barbarplots</a> for other types of data because they hide the distribution.</p>
<p>I’ll show you how to make these with error bars so you can recreate others’ graphs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate mean and SD for each sex</span>
demog %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(sex) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">mean =</span> <span class="kw">mean</span>(height),
    <span class="dt">sd =</span> <span class="kw">sd</span>(height)
  ) %&gt;%
<span class="kw">ggplot</span>(<span class="kw">aes</span>(sex, mean, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean -<span class="st"> </span>sd, <span class="dt">ymax =</span> mean +<span class="st"> </span>sd), <span class="dt">width =</span> <span class="fl">0.25</span>)</code></pre></div>
<p><img src="images/02/barplot-1.png" width="768" /></p>
</div>
<div id="histogram" class="section level3">
<h3>Histogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="images/02/histogram-1.png" width="768" /></p>
<p class="alert alert-info">
Try changing the <code>position</code> argument to “identity”, “fill”, “dodge”, and “stack”.
</p>
</div>
<div id="density-plot" class="section level3">
<h3>Density plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(demog$height)) +
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">45</span>, <span class="dv">90</span>) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Height (in inches)&quot;</span>)</code></pre></div>
<p><img src="images/02/density-1.png" width="768" /></p>
</div>
<div id="grid-of-plots" class="section level3">
<h3>Grid of plots</h3>
<p>You can use the <a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html"><code>cowplot</code></a> package to easily make grids of different graphs. First, you have to assign each plot a name. Then you list all the plots as the first arguments of <code>plot_grid()</code> and provide a list of labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cowplot)

my_hist &lt;-<span class="st"> </span><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(
    <span class="dt">binwidth =</span> <span class="dv">1</span>, 
    <span class="dt">alpha =</span> <span class="fl">0.5</span>, 
    <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, 
    <span class="dt">show.legend =</span> <span class="ot">FALSE</span>
  )

my_violin &lt;-<span class="st"> </span><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(sex, height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_violin</span>(
    <span class="dt">trim =</span> <span class="ot">FALSE</span>,
    <span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.5</span>), 
    <span class="dt">alpha =</span> <span class="fl">0.5</span>, 
    <span class="dt">show.legend =</span> <span class="ot">FALSE</span>
  )

my_box &lt;-<span class="st"> </span><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(sex, height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)

my_density &lt;-<span class="st"> </span><span class="kw">ggplot</span>(demog, <span class="kw">aes</span>(height, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)

my_bar &lt;-<span class="st"> </span>demog %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(sex) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">mean =</span> <span class="kw">mean</span>(height),
    <span class="dt">sd =</span> <span class="kw">sd</span>(height)
  ) %&gt;%
<span class="kw">ggplot</span>(<span class="kw">aes</span>(sex, mean, <span class="dt">fill=</span>sex)) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean -<span class="st"> </span>sd, <span class="dt">ymax =</span> mean +<span class="st"> </span>sd), <span class="dt">width =</span> <span class="fl">0.25</span>)

<span class="kw">plot_grid</span>(
  my_violin, 
  my_box, 
  my_density, 
  my_bar, 
  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)
)</code></pre></div>
<p><img src="images/02/unnamed-chunk-3-1.png" width="768" /></p>
<p class="alert alert-info">
Once you load the cowplot package, your ggplot default theme will change.
</p>
</div>
<div id="scatter-plot" class="section level3">
<h3>Scatter plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(x_vs_y, <span class="kw">aes</span>(x, y)) +
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="images/02/scatter-1.png" width="768" /></p>
</div>
<div id="line-graph" class="section level3">
<h3>Line graph</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(x_vs_y, <span class="kw">aes</span>(x, y)) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="images/02/line-1.png" width="768" /></p>
</div>
<div id="combined-scatter-and-line-graph" class="section level3">
<h3>Combined scatter and line graph</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(x_vs_y, <span class="kw">aes</span>(x, y)) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="images/02/scatter_line-1.png" width="768" /></p>
</div>
<div id="overlapping-data" class="section level3">
<h3>Overlapping Data</h3>
<p>You can deal with overlapping data points (very common if you’re using Likert scales) by reducing the opacity of the points. You need to use trial and error to adjust these so they look right.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(overlap, <span class="kw">aes</span>(x, y)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">05</span>) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="images/02/overlap_alpha-1.png" width="768" /></p>
<p>Alternatively, you can transform your data to create a count column and use the count to set the dot colour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">overlap %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(x, y) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y, <span class="dt">color=</span>count)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">5</span>) +
<span class="st">  </span><span class="kw">scale_color_viridis</span>()</code></pre></div>
<p><img src="images/02/overlap_colour-1.png" width="768" /></p>
<p>Or you can set the size of the dot proportional to the number of overlapping observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">overlap %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(x, y) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y, <span class="dt">size=</span>count)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;#663399&quot;</span>)</code></pre></div>
<p><img src="images/02/overlap_size-1.png" width="768" /></p>
</div>
<div id="heat-map" class="section level3">
<h3>Heat map</h3>
<p>I’ve included the code for creating a correlation matrix from a table of variables, but you don’t need to understand how this is done yet. We’ll cover <code>mutate</code> and <code>gather</code> functions in the <code>dplyr</code> and <code>tidyr</code> lessons.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># generate two sets of correlated variables (a and b)</span>
heatmap &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">a1 =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>),
  <span class="dt">b1 =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>)
) %&gt;%<span class="st"> </span>
<span class="kw">mutate</span>(
  <span class="dt">a2 =</span> a1 +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),
  <span class="dt">a3 =</span> a1 +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),
  <span class="dt">a4 =</span> a1 +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),
  <span class="dt">b2 =</span> b1 +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),
  <span class="dt">b3 =</span> b1 +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),
  <span class="dt">b4 =</span> b1 +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)
) %&gt;%
<span class="kw">cor</span>() %&gt;%<span class="st"> </span><span class="co"># create the correlation matrix</span>
<span class="kw">as.data.frame</span>() %&gt;%<span class="st"> </span><span class="co"># make it a data frame</span>
<span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;V1&quot;</span>) %&gt;%<span class="st"> </span><span class="co"># set rownames as V1</span>
<span class="kw">gather</span>(<span class="st">&quot;V2&quot;</span>, <span class="st">&quot;r&quot;</span>, a1:b4) <span class="co"># wide to long (V2)</span></code></pre></div>
<p>Once you have a correlation matrix in the correct (long) format, it’s easy to make a heatmap using <code>geom_tile()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(heatmap, <span class="kw">aes</span>(V1, V2, <span class="dt">fill=</span>r)) +
<span class="st">  </span><span class="kw">geom_tile</span>() +
<span class="st">  </span><span class="kw">scale_fill_viridis</span>()</code></pre></div>
<p><img src="images/02/heatmap-1.png" width="768" /></p>
</div>
</div>
<div id="exercises" class="section level2 tabset tabset-pills">
<h2>Exercises</h2>
<div id="distribution" class="section level3">
<h3>Distribution</h3>
<p>Generate a violin plot, boxplot, histogram, density plot, and barplot for the following data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dog weights estimated from http://petobesityprevention.org/ideal-weight-ranges/</span>

dogs &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">breed =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;beagle&quot;</span>, <span class="st">&quot;boxer&quot;</span>, <span class="st">&quot;bulldog&quot;</span>), <span class="dt">each =</span> <span class="dv">100</span>),
  <span class="dt">weight =</span> <span class="kw">c</span>(
    <span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">24</span>, <span class="dv">6</span>),
    <span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="fl">62.5</span>, <span class="fl">12.5</span>),
    <span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">45</span>, <span class="dv">5</span>)
  )
)</code></pre></div>
<div class="solution">
<button>
Violin Plot Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dogs, <span class="kw">aes</span>(breed, weight)) +
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.5</span>))</code></pre></div>
<p><img src="images/02/exercise-violin-1.png" width="768" /></p>
</div>
<div class="solution">
<button>
Boxplot Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dogs, <span class="kw">aes</span>(breed, weight)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="images/02/exercise-boxplot-1.png" width="768" /></p>
</div>
<div class="solution">
<button>
Histogram Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dogs, <span class="kw">aes</span>(weight, <span class="dt">fill=</span>breed)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">3</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="images/02/exercise-histogram-1.png" width="768" /></p>
</div>
<div class="solution">
<button>
Density plot Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dogs, <span class="kw">aes</span>(weight, <span class="dt">fill=</span>breed)) +
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">110</span>)</code></pre></div>
<p><img src="images/02/exercise-density-1.png" width="768" /></p>
</div>
<div class="solution">
<button>
Barplot Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dogs %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(breed) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">mean =</span> <span class="kw">mean</span>(weight),
    <span class="dt">sd =</span> <span class="kw">sd</span>(weight)
  ) %&gt;%
<span class="kw">ggplot</span>(<span class="kw">aes</span>(breed, mean, <span class="dt">fill=</span>breed)) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean -<span class="st"> </span>sd, <span class="dt">ymax =</span> mean +<span class="st"> </span>sd), <span class="dt">width =</span> <span class="fl">0.25</span>)</code></pre></div>
<p><img src="images/02/exercise-barplot-1.png" width="768" /></p>
</div>
</div>
<div id="correlation" class="section level3">
<h3>Correlation</h3>
<p>Represent the relationships among moral, sexual and pathogen disgust scores from the dataset <a href="data/disgust_scores.csv">disgust_scores.csv</a>.</p>
<p>Make sure the graphs have appropriate titles and axis labels and that the range of the axes are the same in all graphs.</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">disgust &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/disgust_scores.csv&quot;</span>)

<span class="kw">ggplot</span>(disgust, <span class="kw">aes</span>(moral, sexual)) +
<span class="st">  </span><span class="kw">geom_smooth</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Moral vs Sexual Disgust&quot;</span>) +
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">6</span>) +<span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">6</span>)</code></pre></div>
<p><img src="images/02/exercise-cor-1.png" width="768" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(disgust, <span class="kw">aes</span>(moral, pathogen)) +
<span class="st">  </span><span class="kw">geom_smooth</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Moral vs Pathogen Disgust&quot;</span>) +
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">6</span>) +<span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">6</span>)</code></pre></div>
<p><img src="images/02/exercise-cor-2.png" width="768" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(disgust, <span class="kw">aes</span>(pathogen, sexual)) +
<span class="st">  </span><span class="kw">geom_smooth</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Pathogen vs Sexual Disgust&quot;</span>) +
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">6</span>) +<span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">6</span>)</code></pre></div>
<p><img src="images/02/exercise-cor-3.png" width="768" /></p>
</div>
</div>
<div id="many-correlated-variables" class="section level3">
<h3>Many correlated variables</h3>
<p>Create a heatmap of the relationships among all the questions in <a href="data/disgust_cors.csv">disgust_cors.csv</a> (the correlations have already been calculated for you).</p>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_csv</span>(<span class="st">&quot;data/disgust_cors.csv&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(V1, V2, <span class="dt">fill=</span>r)) +
<span class="st">  </span><span class="kw">geom_tile</span>() +
<span class="st">  </span><span class="kw">scale_fill_viridis</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</code></pre></div>
<p><img src="images/02/exercise-heatmap-1.png" width="768" /></p>
</div>
</div>
</div>

<!--
<p class="footer">
  This course free to use in any way under the
  <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0 License</a>
</p>
-->

<script>
  $(".solution").click(function() {
    $(this).toggleClass("open");
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
